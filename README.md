# Прогноз внутренней мотивации студентов и завершения онлайн-курса по цифровым следам активности (OULAD)

![Python](https://img.shields.io/badge/python-3.11-blue.svg)
![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)
![Status](https://img.shields.io/badge/status-completed-brightgreen.svg)

---

### tl;dr
Модель машинного обучения предсказывает внутреннюю мотивацию (IMI) и вероятность завершения курса по поведенческим данным студентов Open University (OULAD).  
Использованы интерпретируемые признаки регулярности, самоинициативы и равномерности активности.  
Результат: PR-AUC ≈ **0.93**, ROC-AUC ≈ **0.90**, стабильная калибровка и объяснимые факторы поведения.

## 1. Цель и контекст проекта

**Авторы:** Юрий Нечитайлов, Андрей Петровский  

**Инструменты:** Python 3.11, PyCharm, ChatGPT (вайб-кодинг)  
**Библиотеки:** `pandas`, `numpy`, `scikit-learn`, `lightgbm`, `catboost`, `matplotlib`, `shap`

**Цель:** создать воспроизводимый ML-конвейер, который по данным LMS-активности прогнозирует:
1. уровень внутренней мотивации (IMI),  
2. вероятность завершения курса,  
3. ключевые поведенческие факторы, влияющие на оба показателя.

**Контекст:** проект соединяет психологическую модель внутренней мотивации с аналитикой цифрового поведения в LMS.

## 2. Постановка задачи

**Объект:** цифровые следы студентов в LMS.  
**Предмет:** операционализация внутренней мотивации через поведенческие индикаторы.  
**Гипотеза:** регулярность, равномерность и самоинициативность в активности отражают высокий уровень IMI и повышают вероятность завершения курса.  
**Исследовательский вопрос:** какие признаки активности предсказывают IMI и завершение с наибольшей точностью?

## 3. Обзор решений

| № | Работа / направление | Используемые модели | Недостатки для нашей задачи |
|:-|:-|:-|:-|
| 1 | Open University dropout prediction | GBDT, Logistic Regression | Нет интерпретации и мотивационных индикаторов |
| 2 | Explainable student performance models | SHAP, LIME | Без поведенческой структуры IMI |
| 3 | Behavioral clustering of LMS data | K-means, HDBSCAN | Не привязаны к завершению и мотивации |
| 4 | Motivation modeling in MOOCs | Surveys + ML | Требуют анкетных данных, не масштабируются |

**Вывод:** необходима метрика IMI, вычисляемая по цифровым следам, и модель, которая объясняет её вклад в завершение курса.

## 4. Данные и разведочный анализ

**Источник:** Open University Learning Analytics Dataset (OULAD)  
**Таблицы:** `studentVle`, `studentInfo`, `assessments`  
**Размер:** ≈ 32 000 студентов, 8 курсов, 2 презентации  

**Предобработка:**
- фильтрация студентов с менее чем 3 активными днями;  
- объединение таблиц по `id_student`, `code_module`, `code_presentation`;  
- min-max нормализация внутри курса;  
- кодировка категориальных переменных;  
- сохранение артефактов в `data/processed/features_with_IMI_v1_with_info_v2.csv`.

## 5. Признаковая инженерия

| Признак | Интерпретация |
|:-|:-|
| `regularity_cv` | вариация интервалов активности (равномерность) |
| `last_minute_ratio` | доля активности в последние 2 дня (импульсивность) |
| `self_initiation_rate` | активность вне дедлайнов (самоинициатива) |
| `deep_session_share` | доля «глубоких» сессий (погружённость) |
| `social_evenness` | равномерность по дням (1 − индекс Джини) |
| `route_entropy` | разнообразие типов активности |
| `score_gain_rate` | прирост оценок |
| `active_days` | количество активных дней |

**Интегральный индекс IMI_v1:**  
сумма нормированных позитивных индикаторов (негативные инвертируются).

**Целевые переменные:**
- `IMI_high` — верхний квартиль IMI_v1 (1/0);  
- `final_result_bin` — Pass/Distinction = 1, остальное = 0.

## 6. Модели и обучение

**Использованные модели:**  
- Gradient Boosting (LightGBM / CatBoost) — основная;  
- MLP — контрольная.  

**Стратегия обучения:**  
- train/val/test = 70/15/15;  
- разбиение по студентам (group split);  
- оптимизация по F1 и PR-AUC;  
- фиксация seed и контроль утечек.  

**Калибровка:** ECE = 0.017, MCE = 0.046, Brier = 0.123.

### 📊 Метрики качества (GBDT)

| Метрика | Валидация | Тест |
|:-|:-|:-|
| ROC-AUC | 0.899 | 0.899 |
| PR-AUC | 0.927 | 0.927 |
| F1 | 0.862 | 0.862 |
| Recall (policy ≥ 0.80) | 0.80 | 0.80 |
| Precision @ Recall = 0.80 | 0.864 | 0.864 |

Модель устойчива, хорошо калибрована, интерпретируема.

## 7. Интерпретация и объяснимость

### 🔎 Важность признаков
1. `score_gain_rate` — академическая динамика  
2. `active_days` — общая вовлечённость  
3. `regularity_cv` — ритмичность  
4. `self_initiation_rate` — автономность  
5. `route_entropy` — разнообразие активности  

### 👥 Когортный анализ
- старшие группы (35 +) демонстрируют выше IMI и completion;  
- Spearman ρ (IMI_mean ↔ completion_rate) = **0.298**, p = 0.18

### 📈 Проверка гипотезы
Равномерность и самоинициатива устойчиво связаны с успешностью → **гипотеза подтверждена**. Связь умеренная, статистически незначимая на уровне 0.05, но устойчивая по направлению (ρ ≈ 0.30 во всех выборках).  
Это подтверждает тенденцию: курсы с более высоким средним IMI имеют выше долю завершивших.

## 8. Интерпретация в прикладном контексте

**Научное значение:**  
IMI_v1 — операционализированная поведенческая метрика внутренней мотивации.

**Прикладное значение:**  
Позволяет выявлять студентов с риском снижения мотивации и направлять персонализированные рекомендации (nudges) в LMS Moodle.

## 9. Воспроизводимость и установка

**Требования:**
```bash
python >= 3.10
pip install -r requirements.txt
```

**Запуск:**
```bash
python src/oulad_ingest_features_imi_clusters_v2.py
python src/baselines_imihigh.py
python src/make_report.py
```

**Артефакты:**
```bash
data/processed/features_with_IMI_v1_with_info_v2.csv
data/processed/models_final/val_metrics.csv
data/processed/models_final/test_metrics.csv
data/processed/reports/summary.md
```

## 10. Использование в учебном процессе

- Демонстрация полного ML-конвейера на семинарах по анализу данных.
- Использование блокнотов как шаблонов заданий для студентов.
- Репозиторий подходит для формата «перевёрнутый класс»:  
	изучение, воспроизведение, улучшение модели и защита результата.

## 11. Выводы и рекомендации

1. Реализован воспроизводимый ML-конвейер на данных OULAD.
2. Разработан объяснимый индекс IMI_v1 и модель GBDT с PR-AUC ≈ 0.93.
3. Подтверждена связь IMI с успешностью завершения курса.

**Рекомендации по развитию:**

- GroupKFold и гипертюнинг параметров;
- Байесовская оптимизация весов IMI_v1;
- SHAP-графики и отчёты объяснимости;
- API-модуль интеграции с Moodle;
- Мониторинг дрейфа и fairness-аудит по когортам.

## 12. Иллюстрации

|           SHAP summary           |       Корреляция IMI и завершения       |
| :------------------------------: | :-------------------------------------: |
| ![shap](assets/shap_summary.png) | ![corr](assets/imi_completion_corr.png) |


Рост IMI на 0.1 сопровождается увеличением доли завершивших примерно на 5 п.п.


## 13. Лицензия и авторство

© 2025 Юрий Нечитайлов, Андрей Петровский  
Лицензия — MIT  
Использование разрешено при указании авторства и ссылки на исходный репозиторий.

